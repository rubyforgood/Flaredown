{{partial "components/checkin/step-header"}}

{{#if trackableTypeIsTreatment}}

  {{#each trackeds as |tracked|}}
    {{#unless tracked.isPreparedForDestroy}}
      {{checkin-treatment model=tracked
                          onIsTakenChanged=(action 'saveChanges')
                          onDoseChanged=(action 'saveChanges')
                          onRemove=(action 'remove') }}
    {{/unless}}
  {{/each}}

{{else}}

  {{#each trackeds as |tracked|}}
    {{#unless tracked.isPreparedForDestroy}}
      {{tracked-level model=tracked
                      valueKey='value'
                      onValueChanged=(action 'saveChanges')
                      onRemove=(action 'remove') }}
    {{/unless}}
  {{/each}}

{{/if}}

{{select-field resource=trackableType
               selection=selectedTrackable
               onSelect=(action "add")
               create=true
               fetchItemsOnInit=false
               placeholder=selectPlaceholder
               class="flat"
               optionComponent="select-field/trackable-select-option"
               optionCreateComponent=optionCreateComponent }}

{{#unless embeddedInSummary}}
  {{step-controls step=model.currentStep
                  forwardLabel="Next"
                  disabled=checkin.hasDirtyAttributes
                  onBackward=(action "goBack")
                  onForward=(action "completeStep") }}
{{/unless}}
